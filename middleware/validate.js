var d=(r,s,e)=>new Promise((a,t)=>{var o=n=>{try{i(e.next(n))}catch(c){t(c)}},u=n=>{try{i(e.throw(n))}catch(c){t(c)}},i=n=>n.done?a(n.value):Promise.resolve(n.value).then(o,u);i((e=e.apply(r,s)).next())});import{verify as y}from"jsonwebtoken";var p=(r,s)=>(e,a,t)=>d(void 0,null,function*(){try{s==="query"?yield r.validateAsync(e.query):s==="body"&&(yield r.validateAsync(e.body))}catch(o){a.status(400).send(o.message);return}t()}),m=(r,s)=>(a,t,o)=>d(void 0,null,function*(){let u=a.headers.authorization;if(!u)return t.status(401).send("unauthorized");if(u)try{let i=y(u,s);if(!(yield r.fetch({id:i.user.id})).count)return t.status(401).send("forbidden")}catch(i){return t.status(401).send("internal server error")}o()});export{p as requestDataValidate,m as useApiAuthentication};
