"use strict";var d=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.prototype.hasOwnProperty;var x=(t,e)=>{for(var r in e)d(t,r,{get:e[r],enumerable:!0})},R=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of p(e))!m.call(t,n)&&n!==r&&d(t,n,{get:()=>e[n],enumerable:!(s=h(e,n))||s.enumerable});return t};var b=t=>R(d({},"__esModule",{value:!0}),t);var y=(t,e,r)=>new Promise((s,n)=>{var o=i=>{try{a(r.next(i))}catch(c){n(c)}},u=i=>{try{a(r.throw(i))}catch(c){n(c)}},a=i=>i.done?s(i.value):Promise.resolve(i.value).then(o,u);a((r=r.apply(t,e)).next())});var l={};x(l,{requestDataValidate:()=>q,useApiAuthentication:()=>A});module.exports=b(l);var f=require("jsonwebtoken");var q=(t,e)=>(r,s,n)=>y(void 0,null,function*(){try{e==="query"?yield t.validateAsync(r.query):e==="body"&&(yield t.validateAsync(r.body))}catch(o){s.status(400).send(o.message);return}n()}),A=(t,e)=>(s,n,o)=>y(void 0,null,function*(){let u=s.headers.authorization;if(!u)return n.status(401).send("unauthorized");if(u)try{let a=(0,f.verify)(u,e);if(!(yield t.fetch({id:a.user.id})).count)return n.status(401).send("forbidden")}catch(a){return n.status(401).send("internal server error")}o()});
